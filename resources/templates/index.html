{% extends "base.html" %}
{% block content %}
<h1>Painel do SIGEJ</h1>
<p>Controle rápido de ordens de serviço e estoque do campus.</p>
<div class="grid">
  <a class="btn" href="{{ url_for('os_bp.nova_os') }}">Nova OS</a>
  <a class="btn" href="{{ url_for('movimentos_bp.movimentos') }}">Registrar movimento de estoque</a>
  <a class="btn" href="{{ url_for('variacoes_bp.variacoes') }}">Cadastrar variação de produto</a>
</div>

<div class="card">
  <h2>Ordens de serviço em aberto</h2>
  {% if os_abertas %}
    <table>
      <tr>
        <th>ID</th><th>Número</th><th>Prioridade</th><th>Área</th><th>Tipo</th><th>Solicitante</th><th>Abertura</th>
      </tr>
      {% for row in os_abertas %}
        <tr>
          <td>{{ row[0] }}</td>
          <td>{{ row[1] }}</td>
          <td>{{ row[2] }}</td>
          <td>{{ row[3] }}</td>
          <td>{{ row[4] }}</td>
          <td>{{ row[5] }}</td>
          <td>{{ row[6] }}</td>
        </tr>
      {% endfor %}
    </table>
  {% else %}
    <p>Nenhuma OS em aberto.</p>
  {% endif %}
</div>

<div class="card">
  <h2>Materiais abaixo do ponto de reposição</h2>
  {% if materiais_baixos %}
    <table>
      <tr><th>Produto</th><th>Cód. Interno</th><th>Local</th><th>Qtd</th><th>Ponto reposição</th></tr>
      {% for row in materiais_baixos %}
        <tr>
          <td>{{ row[0] }}</td>
          <td>{{ row[1] }}</td>
          <td>{{ row[2] }}</td>
          <td>{{ row[3] }}</td>
          <td>{{ row[4] }}</td>
        </tr>
      {% endfor %}
    </table>
  {% else %}
    <p>Nenhum material abaixo do ponto de reposição.</p>
  {% endif %}
</div>

<div class="card">
  <h2>Timeline da última OS em aberto</h2>
  {% if timeline_os %}
    <p>OS #{{ os_id_timeline }}</p>
    <table>
      <tr><th>Data/Hora</th><th>Responsável</th><th>Status</th><th>Descrição</th></tr>
      {% for row in timeline_os %}
        <tr>
          <td>{{ row[0] }}</td>
          <td>{{ row[1] }}</td>
          <td>{{ row[2] }}</td>
          <td>{{ row[3] }}</td>
        </tr>
      {% endfor %}
    </table>
  {% else %}
    <p>Sem movimentações para exibir.</p>
  {% endif %}
</div>

<div class="card">
  <h2>Consumo por equipe (outubro/2025)</h2>
  {% if consumo_outubro %}
    <table>
      <tr><th>Equipe</th><th>Produto</th><th>Total</th></tr>
      {% for row in consumo_outubro %}
        <tr>
          <td>{{ row[0] }}</td>
          <td>{{ row[1] }}</td>
          <td>{{ row[2] }}</td>
        </tr>
      {% endfor %}
    </table>
  {% else %}
    <p>Sem registros no período.</p>
  {% endif %}
</div>

<div class="card">
  <h2>OS concluídas por tipo (ano 2025)</h2>
  {% if os_concluidas_ano %}
    <table>
      <tr><th>Tipo</th><th>Total</th></tr>
      {% for row in os_concluidas_ano %}
        <tr>
          <td>{{ row[0] }}</td>
          <td>{{ row[1] }}</td>
        </tr>
      {% endfor %}
    </table>
  {% else %}
    <p>Nenhuma OS concluída no ano informado.</p>
  {% endif %}
</div>
{% endblock %}
