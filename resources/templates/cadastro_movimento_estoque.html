{% extends "base.html" %}
{% block content %}
<h2>Movimentos de estoque</h2>
<div class="hint">
  Precisa preparar dados? <a href="{{ url_for('tipos_movimento_bp.tipos_movimento') }}">Tipos de movimento</a>,
  <a href="{{ url_for('variacoes_bp.variacoes') }}">Variações de produto</a>,
  <a href="{{ url_for('locais_estoque_bp.locais_estoque') }}">Locais de estoque</a>,
  <a href="{{ url_for('funcionarios_bp.cadastro_funcionario') }}">Funcionários</a>,
  <a href="{{ url_for('os_bp.nova_os') }}">Ordens de serviço</a>.
</div>
<form method="post" class="card">
  <label>Variação de produto</label>
  <select name="produto_variacao_id" required>
    <option value="">Selecione</option>
    {% for v in variacoes %}
      <option value="{{ v.id }}">{{ v.id }} — Produto {{ v.produto_id }} — Cor {{ v.cor_id }} — Tam {{ v.tamanho_id }}</option>
    {% endfor %}
  </select>
  <label>Local de estoque</label>
  <select name="local_estoque_id" required>
    <option value="">Selecione</option>
    {% for l in locais %}
      <option value="{{ l.id }}">{{ l.id }} — {{ l.descricao }}</option>
    {% endfor %}
  </select>
  <label>Tipo de movimento</label>
  <select name="tipo_movimento_id" required>
    <option value="">Selecione</option>
    {% for t in tipos_movimento %}
      <option value="{{ t.id }}">{{ t.id }} — {{ t.descricao }} ({{ t.sinal }})</option>
    {% endfor %}
  </select>
  <label>Quantidade</label>
  <input type="number" step="0.01" name="quantidade" required>
  <label>Funcionário (opcional)</label>
  <select name="funcionario_id">
    <option value="">Selecione</option>
    {% for f in funcionarios %}
      <option value="{{ f.id }}">{{ f.id }}</option>
    {% endfor %}
  </select>
  <label>OS (opcional)</label>
  <select name="ordem_servico_id">
    <option value="">Selecione</option>
    {% for o in ordens %}
      <option value="{{ o.id }}">{{ o.id }} — {{ o.numero_sequencial }}</option>
    {% endfor %}
  </select>
  <label>Observação</label>
  <textarea name="observacao" rows="2"></textarea>
  <button class="btn" type="submit">Registrar movimento</button>
</form>

<h3>Últimos movimentos</h3>
<table>
  <tr>
    <th>ID</th><th>Data</th><th>Tipo</th><th>Sinal</th><th>Variação</th><th>Local</th><th>Qtd</th><th>Funcionario</th><th>OS</th><th>Obs</th>
  </tr>
  {% for m in movimentos %}
    <tr>
      <td>{{ m[0] }}</td>
      <td>{{ m[1] }}</td>
      <td>{{ m[2] }}</td>
      <td>{{ m[3] }}</td>
      <td>{{ m[4] }}</td>
      <td>{{ m[5] }}</td>
      <td>{{ m[6] }}</td>
      <td>{{ m[7] }}</td>
      <td>{{ m[8] }}</td>
      <td>{{ m[9] }}</td>
    </tr>
  {% endfor %}
</table>
{% endblock %}
