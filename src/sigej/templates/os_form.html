{% extends "base.html" %}
{% block content %}
<style>
  .grid { display: grid; gap: 16px; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); margin-top: 12px; }
  .card { border: 1px solid #e3e3e3; border-radius: 6px; padding: 12px; background: #fafafa; }
  .card h4 { margin: 0 0 8px; }
  select { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
</style>

<h2>Abrir ordem de serviço</h2>
<div class="hint">
  Precisa cadastrar algo antes? <a href="{{ url_for('solicitantes_bp.solicitantes') }}">Solicitantes</a>,
  <a href="{{ url_for('areas_bp.areas') }}">Áreas</a>,
  <a href="{{ url_for('tipos_os_bp.tipos_os') }}">Tipos de OS</a>,
  <a href="{{ url_for('equipes_bp.equipes') }}">Equipes</a>,
  <a href="{{ url_for('funcionarios_bp.cadastro_funcionario') }}">Líderes</a>.
</div>
<form method="post" class="card">
  <input type="hidden" name="action" value="abrir_os">
  <label>Solicitante</label>
  <select name="solicitante_id" required>
    <option value="">Selecione</option>
    {% for p in pessoas %}
      <option value="{{ p.id }}">{{ p.id }} — {{ p.nome }}</option>
    {% endfor %}
  </select>

  <label>Área do campus</label>
  <select name="area_id" required>
    <option value="">Selecione</option>
    {% for a in areas %}
      <option value="{{ a.id }}">{{ a.id }} — {{ a.descricao }}{% if a.bloco %} (Bloco {{ a.bloco }}){% endif %}</option>
    {% endfor %}
  </select>

  <label>Tipo de OS</label>
  <select name="tipo_os_id" required>
    <option value="">Selecione</option>
    {% for t in tipos_os %}
      <option value="{{ t.id }}">{{ t.id }} — {{ t.descricao }}</option>
    {% endfor %}
  </select>

  <label>Equipe</label>
  <select name="equipe_id" required>
    <option value="">Selecione</option>
    {% for e in equipes %}
      <option value="{{ e.id }}">{{ e.id }} — {{ e.nome }} ({{ e.turno }})</option>
    {% endfor %}
  </select>

  <label>Líder</label>
  <select name="lider_id" required>
    <option value="">Selecione</option>
    {% for f in funcionarios %}
      <option value="{{ f.id }}">{{ f.id }} — Pessoa {{ f.pessoa_id }} — {{ f.nome }}</option>
    {% endfor %}
  </select>

  <label>Prioridade (1-5)</label>
  <input name="prioridade" value="3" type="number" min="1" max="5">

  <label>Descrição</label>
  <textarea name="descricao" rows="3"></textarea>

  <button class="btn" type="submit">Criar OS</button>
</form>
{% endblock %}
